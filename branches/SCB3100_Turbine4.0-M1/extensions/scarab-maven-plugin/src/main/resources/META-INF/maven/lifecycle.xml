<!-- 
	Custom maven lifecycle phases for scarab-maven-plugin
 -->

<lifecycles>
  <lifecycle><!-- lifecycle to generate sql files -->
    <id>sql-init</id>
    <phases>
      <phase><!-- phase form default lifecycle to prepare and to process prerequisites/resource files -->
        <id>process-resources</id>
        <executions>
         <execution>
            <goals><!-- create sql schema files by torque plugin -->
              <goal>org.apache.db.torque:torque-maven-plugin:sql</goal>
            </goals>
            <configuration>
                <targetDatabase>${scarab.database.type}</targetDatabase>
            	<schemaDir>src/schema</schemaDir>
				<outputDir>${project.build.directory}/sql-resources/schema</outputDir>
            	<reportFile>report.${project.artifact.artifactId}.om.generation</reportFile>           
			</configuration>     
          </execution>
          <execution>
            <goals> <!-- copy and filter script files for database content -->
              <goal>resources:copy-resources</goal>
            </goals>
            <configuration>
	              <outputDirectory>${project.build.directory}/sql-resources/source</outputDirectory>
	              <resources>          
	                <resource>
	                  <directory>src/sql</directory>
	                  <filtering>true</filtering>
	                </resource>
	              </resources>              
			</configuration>     
          </execution>
        </executions>
      </phase>
    </phases>
  </lifecycle>
  <lifecycle>
  	<id>prepare-xdocs</id>
 	<phases>
        <phase><!-- phase form default lifecycle to prepare and to process prerequisites for site -->
        <id>pre-site</id>
        <executions>
         <execution>
            <goals><!-- create torque documentation files by torque plugin -->
              <goal>org.apache.db.torque:torque-maven-plugin:documentation</goal>
            </goals>
            <configuration>
                <targetDatabase>${scarab.database.type}</targetDatabase>
            	<schemaDir>src/schema</schemaDir>
				<outputDir>${project.build.directory}/site/databases</outputDir>
            	<reportFile>report.${project.artifact.artifactId}.docs.generation</reportFile>           
			</configuration>     
          </execution>
          <execution>
            <goals><!-- create l10n locales check -->
              <goal>check-l10n</goal>
            </goals>
            <configuration>
                <refFile>src/conf/classes/ScarabBundle_en.properties</refFile>
				<outFileName>site/xdocs/localeerrs.xml</outFileName>
				<fileset>
					<directory>src/conf/classes</directory>
		            <includes>
		              <include>ScarabBundle*.properties</include>
		            </includes>
		            <followSymlinks>false</followSymlinks>
				</fileset>
		        <messageSettings>
					<NotInReference>ERROR</NotInReference>
					<NoTransAllowed>ERROR</NoTransAllowed>
		            <TranslationRequired>ERROR</TranslationRequired>
		            <TranslatedTwiceDiff>ERROR</TranslatedTwiceDiff>
		            <IllegalPattern>ERROR</IllegalPattern>
		            <DifferentAttributeCount>ERROR</DifferentAttributeCount>
		            <CantParseLine>ERROR</CantParseLine>		
		            <DefinedTwice>ERROR</DefinedTwice>
		            <DefinedTwiceDiff>ERROR</DefinedTwiceDiff>		
		            <TranslatedTwice>INFORMATION</TranslatedTwice>
		            <TranslationMissing>INFORMATION</TranslationMissing>
		            <NotTranslated>INFORMATION</NotTranslated>
		        </messageSettings>         
			</configuration>     
          </execution>
          <execution>
            <goals><!-- create l10n db locales check -->
              <goal>check-l10n</goal>
            </goals>
            <configuration>
            	<refFile>src/conf/classes/InitDbScarabBundle_en.properties</refFile>
				<outFileName>site/xdocs/localeerrs_db.xml</outFileName>
				<fileset>
					<directory>src/conf/classes</directory>
		            <includes>
		              <include>InitDbScarabBundle*.properties</include>
		            </includes>
		            <followSymlinks>false</followSymlinks>
				</fileset>
		        <messageSettings>
					<NotInReference>ERROR</NotInReference>
					<NoTransAllowed>ERROR</NoTransAllowed>
		            <TranslationRequired>ERROR</TranslationRequired>
		            <TranslatedTwiceDiff>ERROR</TranslatedTwiceDiff>
		            <IllegalPattern>ERROR</IllegalPattern>
		            <DifferentAttributeCount>ERROR</DifferentAttributeCount>
		            <CantParseLine>ERROR</CantParseLine>		
		            <DefinedTwice>ERROR</DefinedTwice>
		            <DefinedTwiceDiff>ERROR</DefinedTwiceDiff>		
		            <TranslatedTwice>INFORMATION</TranslatedTwice>
		            <TranslationMissing>INFORMATION</TranslationMissing>
		            <NotTranslated>INFORMATION</NotTranslated>
		        </messageSettings>         
			</configuration>     
          </execution>
        </executions>
      </phase>
    </phases>
  </lifecycle>
</lifecycles>
